<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>ESP32 OTA y Dispositivos</title>
  </head>
  <body>
    <h1>Actualizar Firmware (OTA)</h1>
    <form action="/update-firmware" method="POST" enctype="multipart/form-data">
      <label>Device ID (MAC o "all"):</label>
      <input type="text" name="deviceId" placeholder="AA:BB:CC:11:22:33" />
      <br><br>
      <label>Selecciona firmware (.bin):</label>
      <input type="file" name="firmware" accept=".bin" />
      <br><br>
      <button type="submit">Subir y Enviar</button>
    </form>

    <hr>

    <h2>Lista de Dispositivos</h2>
    <ul>
      <% for (let mac in devices) { %>
        <li>
          <strong><%= mac %></strong> - 
          Estado: <%= devices[mac].status %> | 
          Versión: <%= devices[mac].version %> | 
          Nombre: <%= devices[mac].name %> | 
          Último visto: <%= new Date(devices[mac].lastSeen) %>
        </li>
      <% } %>
    </ul>
  </body>
</html>
